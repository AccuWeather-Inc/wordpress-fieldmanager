{"version":3,"sources":["webpack://Fieldmanager/./js/fieldmanager-autocomplete.js"],"names":["fm","$","jQuery","autocomplete","prepare_options","raw_opts","opts","k","push","label","value","enable_autocomplete","each","this","hasClass","ac_params","$el","$hidden","siblings","first","select","e","ui","preventDefault","val","item","trigger","focus","data","source","request","response","custom_args_js_event","custom_data","custom_result","triggerHandler","post","ajaxurl","action","fm_context","fm_subcontext","fm_autocomplete_search","term","fm_search_nonce","fm_search","nonce","fm_custom_args","result","change","on","target","keyCode","addClass","fmLoadModule","document"],"mappings":"YAAA,QAAI,IAAuBA,EAC1B,IAAIA,EAAK,GAGV,IAAYC,IAwFNC,OAtFNF,EAAGG,aAAe,CAEjBC,gBAAiB,SAAUC,GAC1B,IAAIC,EAAO,GACX,IAAM,IAAIC,KAAKF,EAAWC,EAAKE,KAAM,CAAEC,MAAOJ,EAASE,GAAIG,MAAOH,IAClE,OAAOD,GAGRK,oBAAqB,WACpBV,EAAG,iCAAkCW,MAAM,WAC1C,IAAMX,EAAGY,MAAOC,SAAU,2BAA8B,CACvD,IAAIC,EAAY,GACZC,EAAMf,EAAGY,MACTI,EAAUD,EAAIE,SAAU,sBAAuBC,QACnDJ,EAAUK,OAAS,SAAUC,EAAGC,GAC/BD,EAAEE,iBACFP,EAAIQ,IAAKF,EAAGG,KAAKhB,OACjBQ,EAAQO,IAAKF,EAAGG,KAAKf,OAAQgB,QAAS,WAEvCX,EAAUY,MAAQ,SAAUN,EAAGC,GAC9BD,EAAEE,iBACFP,EAAIQ,IAAKF,EAAGG,KAAKhB,QAEbO,EAAIY,KAAM,UACdb,EAAUc,OAAS,SAAUC,EAASC,GAErC,IAAIC,EAAuBhB,EAAIY,KAAM,qBACjCK,EAAc,GAClB,GAAK,MAAuBD,EAAwD,CACnF,IAAIE,EAAgBlB,EAAImB,eAAgBH,GACnC,MAAuBE,IAC3BD,EAAcC,GAIhBjC,EAAEmC,KAAMC,QAAS,CAChBC,OAAQtB,EAAIY,KAAM,UAClBW,WAAYvB,EAAIY,KAAM,WACtBY,cAAexB,EAAIY,KAAM,cACzBa,uBAAwBX,EAAQY,KAChCC,gBAAiBC,UAAUC,MAC3BC,eAAgBb,IACd,SAAUc,GACZhB,EAAUgB,OAGD/B,EAAIY,KAAM,aACrBb,EAAUc,OAAS7B,EAAGG,aAAaC,gBAAiBY,EAAIY,KAAM,kBAIrB,IAA9BZ,EAAIY,KAAM,gBACrBb,EAAUiC,OAAS,SAAU3B,EAAGC,GACzBA,EAAGG,OACRR,EAAQO,IAAK,IACbR,EAAIQ,IAAK,MAKXvB,EAAGY,MAAOoC,GAAI,SAAS,SAAU5B,GAC3BA,EAAE6B,QAAU,KAAOjD,EAAGoB,EAAE6B,QAAS1B,OACrCP,EAAQO,IAAK,IAAKE,QAAS,cAI7BzB,EAAGY,MAAOoC,GAAI,SAAS,SAAU5B,GACd,IAAbA,EAAE8B,SAA8B,IAAb9B,EAAE8B,SAI1BlC,EAAQO,IAAK,IAAMR,EAAIQ,UAIzBvB,EAAGY,MAAOV,aAAcY,GACxBd,EAAGY,MAAOuC,SAAU,iCAMxBC,aAAcrD,EAAGG,aAAaQ,qBAE9BV,EAAGqD,UAAWL,GAAI,6EAA8EjD,EAAGG,aAAaQ,qB","file":"js/fieldmanager-autocomplete.bundle.min.js","sourcesContent":["if ('undefined' === typeof fm) {\n\tvar fm = {};\n}\n\n( function( $ ) {\n\nfm.autocomplete = {\n\n\tprepare_options: function( raw_opts ) {\n\t\tvar opts = [];\n\t\tfor ( var k in raw_opts ) opts.push( { label: raw_opts[k], value: k } );\n\t\treturn opts;\n\t},\n\n\tenable_autocomplete: function() {\n\t\t$( 'input.fm-autocomplete:visible' ).each( function() {\n\t\t\tif ( !$( this ).hasClass( 'fm-autocomplete-enabled' ) ) {\n\t\t\t\tvar ac_params = {};\n\t\t\t\tvar $el = $( this );\n\t\t\t\tvar $hidden = $el.siblings( 'input[type=hidden]' ).first();\n\t\t\t\tac_params.select = function( e, ui ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$el.val( ui.item.label );\n\t\t\t\t\t$hidden.val( ui.item.value ).trigger( 'change' );\n\t\t\t\t};\n\t\t\t\tac_params.focus = function( e, ui ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$el.val( ui.item.label );\n\t\t\t\t}\n\t\t\t\tif ( $el.data( 'action' ) ) {\n\t\t\t\t\tac_params.source = function( request, response ) {\n\t\t\t\t\t\t// Check for custom args\n\t\t\t\t\t\tvar custom_args_js_event = $el.data( 'customArgsJsEvent' );\n\t\t\t\t\t\tvar custom_data = '';\n\t\t\t\t\t\tif ( 'undefined' !== typeof custom_args_js_event && null !== custom_args_js_event ) {\n\t\t\t\t\t\t\tvar custom_result = $el.triggerHandler( custom_args_js_event );\n\t\t\t\t\t\t\tif ( 'undefined' !== typeof custom_result && null !== custom_result ) {\n\t\t\t\t\t\t\t\tcustom_data = custom_result;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$.post( ajaxurl, {\n\t\t\t\t\t\t\taction: $el.data( 'action' ),\n\t\t\t\t\t\t\tfm_context: $el.data( 'context' ),\n\t\t\t\t\t\t\tfm_subcontext: $el.data( 'subcontext' ),\n\t\t\t\t\t\t\tfm_autocomplete_search: request.term,\n\t\t\t\t\t\t\tfm_search_nonce: fm_search.nonce,\n\t\t\t\t\t\t\tfm_custom_args: custom_data\n\t\t\t\t\t\t}, function( result ) {\n\t\t\t\t\t\t\tresponse( result );\n\t\t\t\t\t\t} );\n\t\t\t\t\t};\n\t\t\t\t} else if ( $el.data( 'options' ) ) {\n\t\t\t\t\tac_params.source = fm.autocomplete.prepare_options( $el.data( 'options' ) );\n\t\t\t\t}\n\n\t\t\t\t// data-exact-match is a minimized attribute (see Fieldmanager_Field::get_element_attributes)\n\t\t\t\tif ( typeof $el.data( 'exact-match' ) !== 'undefined' ) {\n\t\t\t\t\tac_params.change = function( e, ui ) {\n\t\t\t\t\t\tif ( !ui.item ) {\n\t\t\t\t\t\t\t$hidden.val( '' );\n\t\t\t\t\t\t\t$el.val( '' );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// Handle the user deleting the input text, which is not an AC 'change'.\n\t\t\t\t\t$( this ).on( 'keyup', function( e ) {\n\t\t\t\t\t\tif ( e.target && '' === $( e.target ).val() ) {\n\t\t\t\t\t\t\t$hidden.val( '' ).trigger( 'change' );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$( this ).on( 'keyup', function( e ) {\n\t\t\t\t\t\tif ( e.keyCode == 27 || e.keyCode == 13 ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$hidden.val( '=' + $el.val() );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t$( this ).autocomplete( ac_params );\n\t\t\t\t$( this ).addClass( 'fm-autocomplete-enabled' );\n\t\t\t}\n\t\t} );\n\t}\n};\n\nfmLoadModule( fm.autocomplete.enable_autocomplete );\n\n$( document ).on( 'fm_collapsible_toggle fm_added_element fm_displayif_toggle fm_activate_tab', fm.autocomplete.enable_autocomplete );\n\n} ) ( jQuery );\n"],"sourceRoot":""}